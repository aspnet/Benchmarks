# Executes the Proxy benchmarks on citrine

parameters:
  scenario: ""

steps:
- bash: |
    IFS="|" read name value <<< "${{ parameters.scenario }}"
    
    # create pipeline variables
    echo "##vso[task.setvariable variable=name]$name"
    echo "##vso[task.setvariable variable=value]$value"

- task: PublishToAzureServiceBus@1
  condition: always()
  inputs:
    azureSubscription: ASP.NET Benchmarks Queue
    displayName: $(name)
    waitForCompletion: true
    messageBody: |
      {
        "name": "benchmarksdriver",
        "args": [ "$(value)" ]
      }
  