# Executes the Proxy benchmarks on citrine

parameters:
- name: scenarios
  values: []

# Agent-less jobs need this pool
pool: server

variables:
  sessionArg: "--session $[format('{0:yyyyMMddHHmm}', pipeline.startTime)]"

jobs:
- job: Trends
  steps:
  - ${{ each s in parameters.scenarios }}:
    - task: PublishToAzureServiceBus@1
      displayName: ${{ s.displayName }}
      condition: always()
      inputs:
        azureSubscription: ASP.NET Benchmarks Queue
        waitForCompletion: true
        messageBody: |
          {
            "name": "benchmarksdriver",
            "args": [ "${{ s.args }} $(sessionArg)" ]
          }
