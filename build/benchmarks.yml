# Orchestrates all benchmarks

variables:
  - template: job-variables.yml
  - name: session
    value: $(Build.BuildNumber)

jobs:
- job: gRPCv2
  pool: server
  timeoutInMinutes: 180
  condition: succeededOrFailed()
  strategy:
    maxParallel: 1
    matrix:
      Intel_Linux:
        profile: aspnet-citrine-lin
      Intel_Windows:
        profile: aspnet-citrine-win
  steps:
  - template: grpc-v2-scenarios.yml
    parameters:
      profile: $(profile)
      warmup: 5
      duration: 15
      connection: 'ASP.NET Benchmarks Queue'
